# 使用手册

在mod工具.xlsx文件夹按照要求填写后，运行ModTools.py即可一键生成mod文件。非常简单。

> 在使用本工具前，你需要确保你的电脑已经安装了Python环境，并且安装了pandas和lxml的库，网络上已经有了详细的方法了，这里就不多赘述。

```
pip install pandas
pip install lxml
```

## 注意事项

1. **文本支持自动添加换行符，不必特意改。**
2. **左侧的列名是关键，你可以将内容放到任意一行，只要最左侧的列名正确，不需要的需要删掉，比如mod并不需要区域，就不要保留区域那一行，如果需要多个区域，就多加几行，最左侧都是中文的区域二字即可。**
3. **在NewCiv页面里，不要留空，就算这一列只是占位符，也要随便填点什么，写个0就行。涉及文本的，除了外交文本和百科文本，都不能留空，哪怕写个1也行。**

## 基础设置

打开**mod工具.xlsx**文件，你可能会被里面密密麻麻的文字吓到，不过其实并不复杂，只需要按照规定填写内容，就能轻松完成一个mod的预设。

> 注意：如无特殊说明，通常1表示true，0表示false。

第一个页面是NewCiv页面，也是最核心的一页。这里的一切数据都是基于第一列的文本来读取的。现在来具体讲解第一部分：基本信息

> 注意：每一列都必须要有内容，不可为空

| 列名     | mod名字       | 语言 | 前缀 | 变量中缀 | 需要辅助函数文件 | 自动加图标 | 是否需要百科文本 | 加载顺序 | 停止使用主函数 |
| -------- | ------------- | ---- | ---- | -------- | ---------------- | ---------- | ---------------- | -------- | -------------- |
| 基本信息 | Siqi_Mod_0001 | 3    | SIQI | 0        | 1                | 0          | 0                | 1234     | 0              |

**mod名字**：就是文件的前缀，例如 **Siqi_Mod_0001_Civilizations.sql** ，也是你创建的工程文件夹名字。

> 注意：必须确保你已经在ModBuddy创建了一个工程文件夹，并且文件夹名字与mod名字相同。

**语言**：文本语音，填1就是中文，填2就追加英文，填3就追加繁中，往后就没有了。填4也只有繁中。不过，本工具只会自动填写中文文本，其他语言只能靠你自己努力了。

**前缀**：变量名的前缀，必须要填，这是避免变量名重复的手段，最好填自己的。通常你的变量名会像是：CIVILIZATION_SIQI_XXX。

**变量中缀**：自适应的中缀，填0表示不用，填大于0的数字就是使用，假设填写了10，如果是文明，中缀会是C0010，那么最终变量名是CIVILIZATION_SIQI_C0010_XXX。可能大部分人都用不上这个，因为这是偷懒用的，可以完全不改文明的简称，只改中缀的数字，然后就是一个新的mod了。

**需要辅助函数文件**：看到这里还有一个Support.lua文件了吗？如果你有一些lua的辅助函数，可以直接写在里面，会自动复制过去。

**自动加图标**：为文本添加[ICON_Food]这样的图标。目前正在施工中，暂时无效。

**是否需要百科文本**：如果需要，会自动生成百科文本，并且可以在 **PediaText页面** 填写。

**加载顺序**：会为你的数据文件自动添加加载顺序，为0时不添加。

**停止使用主函数**：为1时，ModTools.py不会启用主函数，防止后续被覆盖的。

## 文明设置

这个是文明的基本设置，事实上，只要最左侧的是***文明*** 即可，上面的列名，文明简称等等只是用来提示的，不会有任何影响。

| 列名 | 文明简称 | 城市名字 | 市民男数量 | 市民男现代数量 | 市民女数量 | 市民女现代数量 | 文明名字 | 文明能力名字 | 文明能力描述 |
| ---- | -------- | -------- | ---------- | -------------- | ---------- | -------------- | -------- | ------------ | ------------ |
| 文明 | TEST     | 25       | 5          | 5              | 10         | 10             | 测试文明 | 测试能力     | 测试描述     |

**文明简称：** CIVILIZATION_SIQI_XXX的 **XXX** 部分，需要确保你这个文件的文明简称唯一。

**城市名字：** 可以填三种参数：Self，20(也就是数字)，CIVILIZATION_AMERICA(也就是原版文明变量名)

填Self，那么你需要在NewCiv页面中填写如下的行，城市名可以有很多个，前方的文明简称就是锚定。会自动填入，无需额外操作。

| 列名     | 文明简称 | 城市名1 | 城市名2 | 城市名3 | ... |
| -------- | -------- | ------- | ------- | ------- | --- |
| 文明城市 | TEST     | 城市名1 | 城市名2 | 城市名3 | ... |

填数字，为0时就不会填写城市名字，填数字时，就会在CityName里随机抽符合数量的城市名字，也就是共有城市名库，对于明日方舟这种城市名复用率高的mod来说还是很有用的。

填CIVILIZATION_AMERICA或者别的文明变量，就会用SELECT语句复制这个文明的全部城市名。

**市民男数量，市民男现代数量，市民女数量，市民女现代数量：**

市民男数量填Self，那么你需要在至少写一行这样的行，通常最多写4行即可。填了Self后，后面三个填啥都一样，但必须要填，懒得填写个0就完事。

| 列名     | 文明简称 | 性别 | 现代 | 市民名1 | 市民名2 | 市民名3 | ... |
| -------- | -------- | ---- | ---- | ------- | ------- | ------- | --- |
| 文明市民 | TEST     | 1    | 1    | 市民名1 | 市民名2 | 市民名3 | ... |

填数字，和城市名字类似，会在CitizenName页面里抽符合数量的符合性别的市民名字，不过是否现代就不会管了，这是随机的。

填CIVILIZATION_AMERICA或者别的文明变量，就会用SELECT语句复制这个文明的全部市民名。

**文明名字，文明能力名字，文明能力描述：** 直接写中文文本即可，但不要空着，写个1都行。

## 领袖设置

| 列名 | 领袖简称 | 绑定文明 | 性别 | 首都     | 外交文本 | 占位符 | 领袖名字 | 领袖能力名字 | 领袖能力描述 | 加载文本 | 领袖语录 |
| ---- | -------- | -------- | ---- | -------- | -------- | ------ | -------- | ------------ | ------------ | -------- | -------- |
| 领袖 | TEST     | TEST     | 0    | 首都名字 | 1        | 1      | 领袖名字 | 领袖能力名字 | 领袖能力描述 | 加载文本 | 领袖语录 |

这里按照列名来写即可，应该没有难以理解的。

绑定文明写的是我们简称，文明之间不能重复简称而言，但不关文明领袖之间的事。不过最好还是不同名。

**性别**：0是Female,1是Male

**外交文本**：0是不写，1是简易，2是完整，目前正在施工中。

占位符：虽然没用，但还是要随便写点什么。

其他文本看名字即可，写中文。

## 区域，建筑，单位设置

必须在NewCiv写

| 列名 | 简称      | 是否特色 | 数据来源         | 是否取代 | 是否官方图标 | 模型来源         | 名字     | 描述     |
| ---- | --------- | -------- | ---------------- | -------- | ------------ | ---------------- | -------- | -------- |
| 区域 | DIS_TEST  | 1        | DISTRICT_CAMPUS  | 1        | 1            | DISTRICT_CAMPUS  | 区域名字 | 区域描述 |
| 建筑 | BUI_TEST  | 1        | BUILDING_LIBRARY | 1        | 1            | BUILDING_LIBRARY | 建筑名字 | 建筑描述 |
| 单位 | UNIT_TEST | 1        | 0                | 0        | 0            | UNIT_WARRIOR     | 单位名字 | 单位描述 |

**简称**：必须在区域，建筑，单位，改良中唯一，至少这个mod唯一

**是否特色**：一般填1，填写后会自动写TraitType，不写就没有。

> 如果非特色，但是又取代区域，会出现错误，不要这么写。

**数据来源：** **非常关键 ！** 在非0的时候后面的是否取代才有意义。填写你要取代的对象作为数据来源，然后就会使用SELECT语句复制需要的参数。

**是否取代：** 大部分时候填1，当数据来源为0时，这一项没有意义，但不要空着。

**是否官方图标：** 区域和建筑支持2个参数：0和1。0的话就是自己导入图标，若是填1，必须确保**模型来源** 非0，否则会报错。

此外，单位还额外可以填2，因为单位有两个图标要填：单位图标和单位肖像，填0一样，全部自己导入，填1就是全部复制官方的，填2则是，单位图标自己导入，而单位肖像使用官方的。注意，必须确保**模型来源** 非0，否则会报错。

**模型来源：** 大部分时候与数据来源相同，不过也有数据来源为0（也就是自定义）的情况，所以额外加了这个。填入类型，将会自动复制正确的内容到Artdef里。不过目前只支持本体，迭起兴衰，风云变化的模型。

**名字和描述**：不为空即可。

## 改良设置：

| 列名 | 改良简称 | 是否特色 | 占位符 | 占位符 | 占位符 | 模型来源         | 名字     | 描述     |
| ---- | -------- | -------- | ------ | ------ | ------ | ---------------- | -------- | -------- |
| 改良 | IMP_TEST | 1        | 0      | 0      | 0      | IMPROVEMENT_MINE | 改良名字 | 改良描述 |

改良的参数看似更少，其实更多，因为改良无法取代，通常也是唯一性很强的，只能自定义。除了少的参数，基本上都一样。

## 绑定设置：

| 列名         | 文明/领袖     | 简称（向右延伸）           | ...      | ...       | ... |
| ------------ | ------------- | -------------------------- | -------- | --------- | --- |
| 文明绑定     | TEST          | DIS_TEST                   | BUI_TEST | UNIT_TEST | ... |
| 领袖绑定     | TEST          | IMP_TEST                   |          |           | ... |
| **列名**    | **总督简称** | **文明/领袖（向右延伸）** |          |           | ... |
| 总督绑定文明 | GOV_TEST      | TEST                       |          |           | ... |
| 总督绑定领袖 | GOV_TEST      | TEST                       |          |           |     |

文明绑定和领袖绑定只能是绑定 **区域 建筑 单位 改良** 其他的不能绑定。

总督绑定文明/领袖就是绑专属总督用的。不同的是，这里是总督开头，可以绑多个文明/领袖。

## 自定义设置：

### 区域：


### 建筑：


### 单位：


### 改良：


### 总督：


### 政策卡：


### 项目：
